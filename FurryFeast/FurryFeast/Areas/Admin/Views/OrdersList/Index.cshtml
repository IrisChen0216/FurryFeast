@model IEnumerable<FurryFeast.Models.Order>

@{
    ViewData["Title"] = "Index";
}

@section Style{
    <style>
        .unState {
            background-color: gray;
        }

        .btnState {
            display: inline-block;
        }

        .drop {
            background-color: #ffedad;
            color: #3b3b3b;
            box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 1px 5px 0 rgba(0, 0, 0, 0.12);
        }

        .drop:hover {
	        background-color: #ffce78;
        }

        .btn-secondary:hover {
            box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 1px 5px 0 rgba(0, 0, 0, 0.12);
        }

        input {
            outline-style: none;
            border: 1px solid #ccc;
            border-radius: 6px;
            padding-left: 5px;
            width: 100%;
            height: 30px;
        }

        .h1Header > h4 {
            position: relative;
            padding-bottom: 17px;
        }

        .h1Header > h4:before {
            content: "";
            position: absolute;
            left: 25px;
            bottom: 6px;
            width: 100%;
            height: 4px;
            background: #ccc;
        }

        .inActive {
	        background: gray; 
        }
        .inActive >td>span {
	        color: black;
        }

        .checked-class {
            background-color: lightblue;
	        color: black;
        }
    </style>
}

<div class="container-fluid" id="app">
	<div class="p-0 position-relative mt-n4 mx-3 z-index-2">
        <div class="border-radius-lg pt-4 ">
            <div class="mx-2 h1Header col-7 ">
                <h4 style="display: inline-block;" class="ms-1 m-0">Orders</h4><h2 style="display: inline-block;" class="mt-3 mx-2">Index</h2>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <div class="my-4" style="background: white; border-radius: 1rem; padding-bottom: 10px; padding: 10px 0px 10px 0px; border: 1px solid rgb(235 235 235);">
                <div class="row m-0 p-0">
                    @*訂單管理*@
                    <div class="col-2 m-4">
                        <button type="button" class="btn mb-0 " style="background: firebrick" data-bs-toggle="dropdown" data-bs-aria-expanded="false">
                            <a :href="'create'" style="color: white">訂單管理</a>
                        </button>
                        <ul class="dropdown" aria-labelledby="dropdownMenu2">
                            <li><button type="button">全部訂單</button></li>
                            <li><button type="button">已結單</button></li>
                            <li><button type="button">未結單</button></li>
                        </ul>
                    </div>
                    <div class="form-group m-4 col-2 align-items-start">
                        @*新增按鍵*@
                        <button type="button" class="btn mb-0 " style="background: lightpink" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
	                        <a :href="'create'" style="color: white">新增訂單</a>
                        </button>
                        <button type="button" class="btn mb-0 " style="background: lightpink" v-on:click="selectAll">全部勾選</button>
                        <button type="button" class="btn mb-0 " style="background: lightpink" v-on:click="deselectAll">取消勾選</button>
                        <button type="button" class="btn mb-0 " style="background: lightpink" v-on:click="">上架</button>
                        <button type="button" class="btn mb-0 " style="background: lightpink" v-on:click="">下架</button>
                    </div>

                    @*搜尋欄*@
                    <div class="ms-md-auto pe-md-3 d-flex align-items-center col-3 mx-4">
                        <div class="input-group input-group-outline">
                            <label class="form-label">Search ...</label>
                            <input type="text" class="form-control h-100">
                        </div>
                    </div>

                </div>

                <div class="card-body p-0 pb-2">
                    <div class="table-responsive p-0">
                        <table class="table align-items-center mb-0">
                            <thead>
                            <tr>
	                            <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7"></th>
	                            <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">訂單編號</th>
	                            <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">會員ID</th>
	                            <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">會員帳號</th>
	                            <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">訂單成立日期</th>
	                            <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">發貨日期</th>
	                            <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">總金額</th>
	                            <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">明細</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr v-for="(item, index) in ordersData" :key="index" :class="{ 'checked-class': item.checked }">
	                            <td><input type="checkbox" v-model="item.checked"></td>
	                            <template >
		                            <td class="align-middle text-center text-secondary text-xs font-weight-bold">
			                            <span class="">{{item.orderId}}</span>
		                            </td>
                                        <td class="align-middle text-center text-secondary text-xs font-weight-bold">
                                            <span>{{item.memberId}}</span>
		                            </td>
                                        <td class="align-middle text-center text-secondary text-xs font-weight-bold">
                                            <span>{{item.memberAccount}}</span>
		                            </td>
                                        <td class="align-middle text-center text-secondary text-xs font-weight-bold">
                                            <span></span>
		                            </td>
                                        <td class="align-middle text-center text-secondary text-xs font-weight-bold">
                                            <span></span>
		                            </td>
                                        <td class="align-middle text-center text-secondary text-xs font-weight-bold">
                                            <span>{{item.orderTotalPrice}}</span>
		                            </td>
		                            <td class="">
			                            <button class="btn mb-0" style="background: dodgerblue"><a style="color: white" :href="'Details/'+item.orderId">觀看明細</a></button>
		                            </td>
	                            </template>
                            </tr>

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts
{
	<script src="https://unpkg.com/dayjs@1.8.21/dayjs.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	<script>
		var app = new Vue({
			el: '#app',
			data: {
				OrderShipDate: "",
				OrderCreateDate:"", 
				ordersData: {},
				
				btnActive: {
                    visibility: "visible",
					background: "red",
					color: "white"
				},
				btnInactive: {
					visibility:"hidden",
					background: "green",
					color: "black"
				}
			},
			mounted: function() {
				let _this = this;
				_this.getData();

			},
			methods: {
				getData: function() {
					let _this = this;
                    axios.get('/api/orders/GetData').then(response => {
                        _this.ordersData = response.data;
                        console.log(_this.ordersData);

                        _this.OrderShipDate = _this.setDate(_this.ordersData[0].orderShipDate);
                        _this.OrderCreateDate = _this.setDate(_this.ordersData[0].orderCreateDate);

                    }).catch(error => { console.error(error); });

				},
				setDate: function(Date) {
					return dayjs(Date).format('YYYY-MM-DD ddd HH:mm:ss');
				},
                setActive: function(item) {
	                if (item.orderStatus == 0) {
		                item.orderStatus = 1;
	                } else {
		                item.orderStatus = 0;
	                }
                },
				selectAll() {
					this.ordersData = this.ordersData.map(item => ({ ...item, checked: true }));
				},
				deselectAll() {
					this.ordersData = this.ordersData.map(item => ({ ...item, checked: false }));
				}
			}

		})	
	</script>
}
